!function(n,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.PubSub=t():n.PubSub=t()}(this,(function(){return function(){"use strict";var n={412:function(n,t,e){function r(n,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}Object.defineProperty(t,"t",{value:!0});var i=e(775),u=function(){function n(){!function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n)}var t,e,u;return t=n,e=[{key:"set",value:function(n,t,e){for(var r,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:".",o=n.split(u),c=e,f=e,s=0;s<o.length;s++){var a=o[s];if(0===a.length)throw new i.default('"'.concat(n,'" is not a valid property path.'));void 0===c[a]&&(c[a]={}),f=c,c=c[a],r=a}return f[r]=t,e}},{key:"get",value:function(n,t){for(var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:".",r=n.split(e),u=t,o=0;o<r.length;o++){var c=r[o];if(0===c.length)throw new i.default('"'.concat(n,'" is not a valid property path.'));if(void 0===u[c])return null;u=u[c]}return u}}],e&&r(t.prototype,e),u&&r(t,u),n}();t.default=u},775:function(n,t){function e(n){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},e(n)}function r(n,t){if(t&&("object"===e(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(n){if(void 0===n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}(n)}function i(n){var t="function"==typeof Map?new Map:void 0;return i=function(n){if(null===n||(e=n,-1===Function.toString.call(e).indexOf("[native code]")))return n;var e;if("function"!=typeof n)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(n))return t.get(n);t.set(n,r)}function r(){return u(n,arguments,f(this).constructor)}return r.prototype=Object.create(n.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),c(r,n)},i(n)}function u(n,t,e){return u=o()?Reflect.construct:function(n,t,e){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(n,r));return e&&c(i,e.prototype),i},u.apply(null,arguments)}function o(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(n){return!1}}function c(n,t){return c=Object.setPrototypeOf||function(n,t){return n.__proto__=t,n},c(n,t)}function f(n){return f=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},f(n)}Object.defineProperty(t,"t",{value:!0});var s=function(n){!function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),t&&c(n,t)}(u,n);var t,e,i=(t=u,e=o(),function(){var n,i=f(t);if(e){var u=f(this).constructor;n=Reflect.construct(i,arguments,u)}else n=i.apply(this,arguments);return r(this,n)});function u(n){var t;return function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=i.call(this,n)).name="InvalidParameterException",t}return u}(i(Error));t.default=s},524:function(n,t,e){function r(n){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},r(n)}function i(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function u(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),t&&b(n,t)}function o(n){var t=l();return function(){var e,r=v(n);if(t){var i=v(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return c(this,e)}}function c(n,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return f(n)}function f(n){if(void 0===n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function s(n){var t="function"==typeof Map?new Map:void 0;return s=function(n){if(null===n||(e=n,-1===Function.toString.call(e).indexOf("[native code]")))return n;var e;if("function"!=typeof n)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(n))return t.get(n);t.set(n,r)}function r(){return a(n,arguments,v(this).constructor)}return r.prototype=Object.create(n.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),b(r,n)},s(n)}function a(n,t,e){return a=l()?Reflect.construct:function(n,t,e){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(n,r));return e&&b(i,e.prototype),i},a.apply(null,arguments)}function l(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(n){return!1}}function b(n,t){return b=Object.setPrototypeOf||function(n,t){return n.__proto__=t,n},b(n,t)}function v(n){return v=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},v(n)}Object.defineProperty(t,"t",{value:!0}),t.SubscriptionNotFoundException=t.SubscriptionAlreadyExistsException=t.InvalidArgumentException=t.DomainException=void 0;var h=function(n){u(e,n);var t=o(e);function e(){return i(this,e),t.apply(this,arguments)}return e}(s(Error));t.DomainException=h;var y=e(552),d=function(n){u(e,n);var t=o(e);function e(n){var r;return i(this,e),(r=t.call(this,n)).name=r.constructor.name,(0,y.captureStackTrace)(f(r),r.constructor),r}return e}(h);t.InvalidArgumentException=d;var p=function(n){u(e,n);var t=o(e);function e(n,r){var u;return i(this,e),(u=t.call(this,'Unable to add subscription "'.concat(n,'" to component "').concat(r,'" because it already manage a subscription with same id.'))).name=u.constructor.name,(0,y.captureStackTrace)(f(u),u.constructor),u}return e}(h);t.SubscriptionAlreadyExistsException=p;var w=function(n){u(e,n);var t=o(e);function e(n,r){var u;return i(this,e),(u=t.call(this,'Unable to find subscription with id "'.concat(n,'" in component "').concat(r,'".'))).name=u.constructor.name,(0,y.captureStackTrace)(f(u),u.constructor),u}return e}(h);t.SubscriptionNotFoundException=w},413:function(n,t){Object.defineProperty(t,"t",{value:!0}),t.generateId=void 0;var e=new Map;t.generateId=function(n){var t,r=null!==(t=e.get(n))&&void 0!==t?t:0;return e.set(n,r+1),"".concat(n,"_").concat(r)}},552:function(n,t){Object.defineProperty(t,"t",{value:!0}),t.captureStackTrace=void 0;t.captureStackTrace=function(n,t){"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(n,t)}},322:function(n,t,e){Object.defineProperty(t,"t",{value:!0}),t.subscribeFromObject=void 0;var r=new(e(412).default);t.subscribeFromObject=function(n,t,e){Object.values(e).forEach((function(e){var i=n[e.action];if("function"==typeof i){var u=i.bind(n);n.subscribe(t,e.notification,(function(n){var t={};if(void 0!==e.mapAttributes){var i=e.mapAttributes;Object.keys(i).forEach((function(e){var u,o=null!==(u=i[e])&&void 0!==u?u:"";t[e]=r.get(o,n)})),u(t)}else u(n)}))}}))}},537:function(n,t,e){Object.defineProperty(t,"t",{value:!0}),t.HIGH_PRIORITY=t.DEFAULT_PRIORITY=t.LOW_PRIORITY=t.ROLE=t.findSubscriptionByRoleAndComponentId=void 0;var r=e(524);t.findSubscriptionByRoleAndComponentId=function(n,e,i){if(e!==t.ROLE.PUBLISHER_ID&&e!==t.ROLE.SUBSCRIBER_ID)throw new r.InvalidArgumentException('Invalid argument given for "role" in "findSubscriptionByRoleAndComponentId". Values expected are "publisher_id" or "subscriber_id" but "'.concat(e,'" was given.'));return n.getSubscriptions().filter((function(n){return(e===t.ROLE.PUBLISHER_ID?n.publisher_id:n.subscriber_id)===i}))},t.ROLE={PUBLISHER_ID:"publisher_id",SUBSCRIBER_ID:"subscriber_id"},t.LOW_PRIORITY=-100,t.DEFAULT_PRIORITY=0,t.HIGH_PRIORITY=100},986:function(n,t,e){function r(n,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}Object.defineProperty(t,"t",{value:!0});var i=e(829),u=e(757),o=e(537),c=e(524),f=function(){function n(t){!function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.proxies=new Map,this.removedSelfSubscription=new Set,this.id=t,this.publisher=new i.default(t),this.subscriber=new u.default(t)}var t,e,f;return t=n,e=[{key:"hasSubscription",value:function(n){return this.subscriber.hasSubscription(n)||this.publisher.hasSubscription(n)}},{key:"addSubscriber",value:function(n,t){this.publisher.addSubscriber(n,t)}},{key:"removeSubscriber",value:function(n){this.publisher.removeSubscriber(n)}},{key:"getNbSubscriptionsAsPublisher",value:function(){return this.publisher.getNbSubscriptions()}},{key:"getNbSubscriptionsAsSubscriber",value:function(){return this.subscriber.getNbSubscriptions()}},{key:"publish",value:function(n,t){this.publisher.publish(n,t)}},{key:"getId",value:function(){return this.id}},{key:"subscribe",value:function(n,t,e,r){return this.subscriber.subscribe.apply(this,[n,t,e,r])}},{key:"getNbSubscriptions",value:function(){return this.subscriber.getNbSubscriptions()}},{key:"removeSubscription",value:function(n){this.subscriber.removeSubscription(n)}},{key:"addSubscription",value:function(n,t){this.subscriber.addSubscription(n,t)}},{key:"waitUntil",value:function(n){return this.subscriber.waitUntil(n)}},{key:"destroy",value:function(){this.publisher.destroy(),this.subscriber.destroy()}},{key:"is",value:function(n){return this.id===n}},{key:"findSubscriptionById",value:function(n){return this.subscriber.findSubscriptionById(n)||this.publisher.findSubscriptionById(n)}},{key:"findSubscriptionsByNotificationAndPublisherId",value:function(n,t){return this.subscriber.findSubscriptionsByNotificationAndPublisherId(n,t)}},{key:"findSubscriptionsByNotification",value:function(n){return this.subscriber.findSubscriptionsByNotification(n).concat(this.publisher.findSubscriptionsByNotification(n))}},{key:"getSubscriptions",value:function(){return this.subscriber.getSubscriptions().concat(this.publisher.getSubscriptions())}},{key:"unsubscribeFromNotification",value:function(n){this.subscriber.unsubscribeFromNotification(n)}},{key:"unsubscribeFromPublisherId",value:function(n){this.subscriber.unsubscribeFromPublisherId(n)}},{key:"unsubscribeFromSubscriptionId",value:function(n){this.subscriber.unsubscribeFromSubscriptionId(n)}},{key:"continuePublicationOnException",value:function(){this.publisher.continuePublicationOnException()}},{key:"findSubscriptionByPublisherId",value:function(n){var t=this.subscriber.findSubscriptionByPublisherId(n).concat((0,o.findSubscriptionByRoleAndComponentId)(this.publisher,o.ROLE.PUBLISHER_ID,n));return n===this.getId()?Array.from(new Set(t)):t}},{key:"findSubscriptionsByNotificationAndSubscriberId",value:function(n,t){return this.publisher.findSubscriptionsByNotificationAndSubscriberId(n,t)}},{key:"findSubscriptionBySubscriberId",value:function(n){var t=this.publisher.findSubscriptionBySubscriberId(n).concat((0,o.findSubscriptionByRoleAndComponentId)(this.subscriber,o.ROLE.SUBSCRIBER_ID,n));return n===this.getId()?Array.from(new Set(t)):t}},{key:"stopPublicationOnException",value:function(){this.publisher.stopPublicationOnException()}},{key:"clearSubscription",value:function(n){if(this.removedSelfSubscription.has(n))this.removedSelfSubscription.delete(n);else{var t=this.findSubscriptionById(n);if(null===t)throw new c.SubscriptionNotFoundException(n,this.getId());(null==t?void 0:t.subscriber_id)===this.subscriber.getId()&&this.subscriber.clearSubscription(n),(null==t?void 0:t.publisher_id)===this.publisher.getId()&&this.publisher.clearSubscription(n),(null==t?void 0:t.publisher_id)===(null==t?void 0:t.subscriber_id)&&this.removedSelfSubscription.add(n)}}},{key:"addProxy",value:function(n,t){var e=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(n){return n},i=this.getPublisherProxies(n.getId()),u=this.subscribe(n,t,(function(n){e.publish(t,r(n))}));return i.add(u.id),this.proxies.set(n.getId(),i),this}},{key:"getPublisherProxies",value:function(n){var t;return null!==(t=this.proxies.get(n))&&void 0!==t?t:new Set}},{key:"removeProxy",value:function(n,t){var e=this,r=this.findSubscriptionsByNotificationAndPublisherId(t,n.getId()),i=this.getPublisherProxies(n.getId());return r.filter((function(n){return i.has(n.id)})).forEach((function(n){e.unsubscribeFromSubscriptionId(n.id),i.delete(n.id)})),this}}],e&&r(t.prototype,e),f&&r(t,f),n}();t.default=f},829:function(n,t,e){function r(n){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},r(n)}function i(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function u(n,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}function o(n,t){return o=Object.setPrototypeOf||function(n,t){return n.__proto__=t,n},o(n,t)}function c(n){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(n){return!1}}();return function(){var e,r=s(n);if(t){var i=s(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return f(this,e)}}function f(n,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(n){if(void 0===n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}(n)}function s(n){return s=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},s(n)}Object.defineProperty(t,"t",{value:!0});var a=e(657),l=e(537),b=function(n){!function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),t&&o(n,t)}(s,n);var t,e,r,f=c(s);function s(){var n;return i(this,s),(n=f.apply(this,arguments)).shouldIStopPublicationOnException=!1,n}return t=s,(e=[{key:"stopPublicationOnException",value:function(){this.shouldIStopPublicationOnException=!0}},{key:"continuePublicationOnException",value:function(){this.shouldIStopPublicationOnException=!1}},{key:"publish",value:function(n,t){var e=this,r=this.notificationsCollection[n];Array.isArray(r)&&r.slice(0).forEach((function(n){try{n.handler(t)}catch(n){if(e.shouldIStopPublicationOnException)throw n}}))}},{key:"findSubscriptionBySubscriberId",value:function(n){return(0,l.findSubscriptionByRoleAndComponentId)(this,l.ROLE.SUBSCRIBER_ID,n)}},{key:"findSubscriptionsByNotificationAndSubscriberId",value:function(n,t){return this.findSubscriptionsByNotification(n).filter((function(n){return n.subscriber_id===t}))}},{key:"addSubscriber",value:function(n,t){this.addSubscription(n,t)}},{key:"removeSubscriber",value:function(n){this.findSubscriptionBySubscriberId(n).forEach((function(n){return n.unsubscribe()}))}}])&&u(t.prototype,e),r&&u(t,r),s}(a.default);t.default=b},757:function(n,t,e){function r(n){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},r(n)}function i(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function u(n,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}function o(n,t){return o=Object.setPrototypeOf||function(n,t){return n.__proto__=t,n},o(n,t)}function c(n){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(n){return!1}}();return function(){var e,r=s(n);if(t){var i=s(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return f(this,e)}}function f(n,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(n){if(void 0===n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}(n)}function s(n){return s=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},s(n)}Object.defineProperty(t,"t",{value:!0});var a=e(657),l=e(537),b=e(524),v=e(413),h=function(n){!function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),t&&o(n,t)}(a,n);var t,e,f,s=c(a);function a(){return i(this,a),s.apply(this,arguments)}return t=a,e=[{key:"unsubscribeFromSubscriptionId",value:function(n){var t=this.findSubscriptionById(n);if(null===t)throw new b.SubscriptionNotFoundException(n,this.getId());t.unsubscribe()}},{key:"findSubscriptionByPublisherId",value:function(n){return(0,l.findSubscriptionByRoleAndComponentId)(this,l.ROLE.PUBLISHER_ID,n)}},{key:"unsubscribeFromPublisherId",value:function(n){this.findSubscriptionByPublisherId(n).map((function(n){return n.unsubscribe})).forEach((function(n){n()}))}},{key:"unsubscribeFromNotification",value:function(n){this.findSubscriptionsByNotification(n).map((function(n){return n.unsubscribe})).forEach((function(n){n()}))}},{key:"subscribe",value:function(n,t,e){var i=this,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:l.DEFAULT_PRIORITY,o=this.getNbSubscriptions(),c="sub_".concat(this.getId(),"_to_").concat(n.getId(),"_salt_").concat(o);if(isNaN(u)||"number"!=typeof u)throw new b.InvalidArgumentException('Unable to create a subscription with priority "'.concat(u,'" (typed as "').concat(r(u),'"). Number value is expected.'));var f={id:c,subscriber_id:this.getId(),publisher_id:n.getId(),unsubscribe:function(){n.clearSubscription(c),i.clearSubscription(c)},priority:u,handler:e};return this.addSubscription(t,f),n.addSubscriber(t,f),f}},{key:"getNbSubscriptions",value:function(){return this.nbSubscriptionRecorded}},{key:"removeSubscription",value:function(n){this.clearSubscription(n)}},{key:"waitUntil",value:function(n){var t=new a((0,v.generateId)("wait-until-".concat(n.map((function(n){return n.name})).join("-and-"),"-salt")));return new Promise((function(e){Promise.all(n.map((function(n){return new Promise((function(e){t.subscribe(n.from,n.name,(function(n){e(n)}))}))}))).then((function(n){t.destroy(),e(n)}))}))}},{key:"findSubscriptionsByNotificationAndPublisherId",value:function(n,t){return this.findSubscriptionsByNotification(n).filter((function(n){return n.publisher_id===t}))}}],e&&u(t.prototype,e),f&&u(t,f),a}(a.default);t.default=h},657:function(n,t,e){function r(n){return function(n){if(Array.isArray(n))return i(n)}(n)||function(n){if("undefined"!=typeof Symbol&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}(n)||function(n,t){if(!n)return;if("string"==typeof n)return i(n,t);var e=Object.prototype.toString.call(n).slice(8,-1);"Object"===e&&n.constructor&&(e=n.constructor.name);if("Map"===e||"Set"===e)return Array.from(n);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return i(n,t)}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(n,t){(null==t||t>n.length)&&(t=n.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=n[e];return r}function u(n,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}Object.defineProperty(t,"t",{value:!0});var o=e(524),c=function(){function n(t){!function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.subscriptionsList={},this.notificationsCollection={},this.nbSubscriptionRecorded=0,this.id=t}var t,e,i;return t=n,(e=[{key:"getSubscriptions",value:function(){return[].concat.apply([],Object.values(this.notificationsCollection))}},{key:"getNbSubscriptions",value:function(){return this.nbSubscriptionRecorded}},{key:"hasSubscription",value:function(n){return void 0!==this.subscriptionsList[n]}},{key:"recordSubscription",value:function(n,t){this.subscriptionsList[n]=t}},{key:"findSubscriptionIndexById",value:function(n){var t=this.subscriptionsList[n],e={index:-1,notification:null!=t?t:""};if(void 0===t)return e;var r=this.notificationsCollection[t];return Array.isArray(r)&&(e.index=r.findIndex((function(t){return t.id===n}))),e}},{key:"findSubscriptionById",value:function(n){var t=this.findSubscriptionIndexById(n);return t.index<0?null:this.notificationsCollection[t.notification][t.index]}},{key:"findSubscriptionsByNotification",value:function(n){return this.notificationsCollection[n]||[]}},{key:"clearSubscription",value:function(n){var t=this.findSubscriptionIndexById(n);if(t.index<0)throw new o.SubscriptionNotFoundException(n,this.getId());var e=this.notificationsCollection[t.notification].splice(t.index,1)[0];"function"==typeof e.handler&&delete e.handler,delete this.subscriptionsList[n],this.nbSubscriptionRecorded--,0===this.notificationsCollection[t.notification].length&&delete this.notificationsCollection[t.notification]}},{key:"addSubscription",value:function(n,t){if(!0!==Array.isArray(this.notificationsCollection[n])&&(this.notificationsCollection[n]=[]),this.hasSubscription(t.id))throw new o.SubscriptionAlreadyExistsException(t.id,this.getId());this.notificationsCollection[n].push(t),this.notificationsCollection[n].sort((function(n,t){return t.priority-n.priority})),this.recordSubscription(t.id,n),this.nbSubscriptionRecorded++}},{key:"getId",value:function(){return this.id}},{key:"is",value:function(n){return n===this.getId()}},{key:"destroy",value:function(){Object.values(this.notificationsCollection).forEach((function(n){r(n).forEach((function(n){n.unsubscribe()}))}))}}])&&u(t.prototype,e),i&&u(t,i),n}();t.default=c}},t={};function e(r){var i=t[r];if(void 0!==i)return i.exports;var u=t[r]={exports:{}};return n[r](u,u.exports,e),u.exports}var r={};return function(){var n=r;Object.defineProperty(n,"t",{value:!0}),n.SubscriptionNotFoundException=n.SubscriptionAlreadyExistsException=n.InvalidArgumentException=n.SubscriberHelper=n.PublisherSubscriber=n.Subscriber=n.Publisher=void 0;var t=e(829);Object.defineProperty(n,"Publisher",{enumerable:!0,get:function(){return t.default}});var i=e(757);Object.defineProperty(n,"Subscriber",{enumerable:!0,get:function(){return i.default}});var u=e(986);Object.defineProperty(n,"PublisherSubscriber",{enumerable:!0,get:function(){return u.default}}),n.SubscriberHelper=e(322);var o=e(524);Object.defineProperty(n,"InvalidArgumentException",{enumerable:!0,get:function(){return o.InvalidArgumentException}}),Object.defineProperty(n,"SubscriptionAlreadyExistsException",{enumerable:!0,get:function(){return o.SubscriptionAlreadyExistsException}}),Object.defineProperty(n,"SubscriptionNotFoundException",{enumerable:!0,get:function(){return o.SubscriptionNotFoundException}})}(),r}()}));